# Plan: 3.3b.07 â€” Nullability Chain Normalization (No Redundant `nullable()`)

**Status:** ðŸ”² Not Started  
**Priority:** Low  
**Created:** 2026-02-13  
**Last Updated:** 2026-02-13  
**Parent:** [roadmap.md](../../roadmap.md) (Session 3.3b)

---

## Goal

Ensure the Zod writer emits a canonical, non-redundant nullability representation:

- avoid emitting chains like `z.null().nullable()` when they add no meaning,
- preserve meaning deterministically,
- keep parser and writer in lockstep.

---

## Responsibility Boundary

**Begins after:** [3.3b.06 â€” Expand Zod Fixtures](3.3b-06-expand-zod-fixtures.md)
**This plan owns:** Nullability chain normalization in Zod writer output. Ensuring canonical and idempotent representation.
**This plan does NOT own:** Other writer output issues (format parity is plan 04). This is the final deliverable of Session 3.3b.
**Successor:** Phase 4 (JSON Schema + Parity Track) per roadmap.

---

## Work

1. Define the canonical Zod 4 nullability encoding for this repo.
2. Update writer emission to avoid redundant chains.
3. Add tests proving:
   - output is canonical,
   - output is idempotent.

---

## Acceptance Criteria

- No redundant nullability chains are emitted in normalized output.
- Idempotency tests cover the nullability normalization behavior.

---

## References

- `lib/src/schema-processing/writers/zod/`
- `.agent/plans/roadmap.md` (Session 3.3b; strictness blockers)
