# Plan: 3.3a.07 â€” Remove Escape Hatches (Type Assertions, any, eslint-disable)

**Status:** ðŸ”² Not Started  
**Priority:** High  
**Created:** 2026-02-13  
**Last Updated:** 2026-02-13  
**Parent:** [roadmap.md](../../roadmap.md) (Session 3.3a)

---

## Goal

Bring product code into strict alignment with `.agent/directives/RULES.md`:

- no `as` (except `as const`),
- no `any`,
- no non-null assertions (`!`),
- no `eslint-disable` to bypass correctness.

If a boundary is untyped, add runtime validation and infer types from it.

---

## Responsibility Boundary

**Begins after:** [3.3a.06 â€” Remove Swallowed Errors](3.3a-06-remove-swallowed-errors.md)
**This plan owns:** Eliminating type-system escape hatches (`as`, `any`, `!`, `eslint-disable`) in product code. Replacing with runtime validation, typed construction, or architectural refactors.
**This plan does NOT own:** Semantic parsing violations (plan 03), centralization (plan 04), or output/input error handling (plans 05-06).
**Successor:** [3.3a.08 â€” Prove Determinism](3.3a-08-prove-determinism.md)

---

## Repo Truth (Known Violations)

- Type assertion + eslint disable:
  - `lib/src/schema-processing/parsers/openapi/index.ts`
- Weak system-boundary typing patterns:
  - `lib/src/shared/types.ts`

---

## Work

1. Inventory current escape hatches in product code (`lib/src/**` excluding tests).
2. Replace type assertions with:
   - real runtime validation, or
   - typed construction, or
   - architectural refactors that preserve type information.
3. Enforce via lint rules (and keep them enabled).

---

## Acceptance Criteria

- Escape hatches are eliminated from product code (tests may be handled separately by policy).
- Lint enforces the rule without exceptions.
- Any boundary validation introduced is deterministic and tested.

---

## References

- `.agent/directives/RULES.md`
- `lib/src/schema-processing/parsers/openapi/index.ts`
- `lib/src/shared/types.ts`
