# Plan: 3.3a.01 ‚Äî ADR-026 Scope Definition (AST vs Data Strings)

**Status:** üî≤ Not Started  
**Priority:** High  
**Created:** 2026-02-13  
**Last Updated:** 2026-02-13  
**Parent:** [roadmap.md](../../roadmap.md) (Session 3.3a)

---

## Goal

Define a repo-specific, enforceable scope for ADR-026 that is:

- architecturally correct (targets brittle TS-source parsing heuristics),
- consistent with strict doctrine (fail fast, no tolerance paths),
- consistent with repo truth (string parsing is sometimes correct for OpenAPI/JSON Schema data strings),
- precise enough to drive ESLint enforcement without loopholes.

---

## Scope Statement (What ADR-026 Means Here)

ADR-026 forbids **string/regex heuristics for parsing TypeScript source code** when we already have an AST and semantic APIs (ts-morph).

It does not forbid all string operations everywhere. It requires that **data-string parsing** (OpenAPI `$ref`, media types, URL templates) be:

- centralized,
- validated,
- tested,
- and fail-fast on invalid inputs.

---

## Deliverables

- A short, canonical scope statement added to:
  - `docs/architectural_decision_records/ADR-026-no-string-manipulation-for-parsing.md` (if needed)
  - `.agent/plans/roadmap.md` (Session 3.3a summary)
  - `.agent/prompts/session-entry.prompt.md` (operator-level summary)
- A list of repo globs for ‚ÄúTS-source parsing modules‚Äù vs ‚Äúdata-string parsing utilities‚Äù to drive ESLint scoping.

---

## Acceptance Criteria

- ADR-026 scope is written down in one canonical place and linked from plans/prompts.
- The scope is specific enough to implement linting without:
  - banning legitimate discriminated-union comparisons, or
  - accidentally disabling repo-wide regex bans in `schema-processing/`.
- The scope explicitly states strictness requirements:
  - unsupported/lossy patterns are rejected (hard error),
  - no silent fallbacks or ‚Äúbest-effort‚Äù outputs.

---

## References

- `docs/architectural_decision_records/ADR-026-no-string-manipulation-for-parsing.md`
- `lib/src/schema-processing/parsers/zod/`
- `lib/src/schema-processing/parsers/openapi/`
- `lib/src/shared/ref-resolution.ts`
